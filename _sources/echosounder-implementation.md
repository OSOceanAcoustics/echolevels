# Implementation for echosounder data

## Current implementations

We are aware of only two efforts that have adopted data processing levels for echosounder data products: ADEON (Atlantic Deepwater Ecosystem Observatory Network; Heaney et al, 2020) and IMOS (the Australian Integrated Marine Observing System; Haris et al 2018, 2021). ADEON developed a set of six processing levels (L0 - L5) for passive and active acoustics, where L0 corresponds to raw, unprocessed data files generated by the instruments; L1 contains calibrated time series data, including calibrated volume backscattering strength (_Sv_); L2 is the first level of data processed from the calibrated data, such as depth-integrated _Sv_ with noise removal applied; and L3 - L5 contain higher-order processing, including signal classifications, interpolated products and synthesis or modeled products. These levels were compared using a table aligning with processing levels from NASA EOS and from the French IFREMER program (IFREMER, 2019). In practice, the ADEON focus for active acoustics in Heaney et al (2020) was largely on L0 - L2. Straightforward data formats were used for the resulting products (e.g., csv).

The IMOS SOOP-BA NetCDF convention (Ships of Opportunity Bio-Acoustic, Haris et al, 2018, 2021) is focused on derived data categorized as L2 using the broader IMOS “file_version” processing level categorization for marine data that also includes L0 (Raw data) and L1 (Quality controlled data). These data are stored in a NetCDF format that is metadata rich and follows broader ocean and earth science data and metadata standards. IMOS SOOP-BA products (referred to simply as IMOS hereon) include several variables, including processed _Sv_ (motion correction and filtering, noise removal), uncorrected and unfiltered _Sv_, metrics derived from _Sv_, and ancillary oceanographic data. Unmodified raw data files are archived and made available only upon request (Haris, K., pers. comm.).


## Proposed Processing Levels and Sub-levels

- TODO: Decision process and principles guiding our designing levels for echosounder data?
- Once I’ve fleshed out the section above on “heterogeneous observing systems”, do another pass for the Rationale statements below, to see if something should be added.
- Also, intent in the use of sub-levels.


### Level 0 (L0)

**Description:** Raw data in vendor sensor format. The data files are typically binary. Associated metadata may be found in external files.

**Rationale:** The use of L0 data processing level for raw data files in their original form is the most widespread practice in both satellite remote sensing (Weaver, 2014; Mittaz et al., 2019; NASA, 2021) and echosounder data programs (Hari et al, 2018; Heaney et al, 2020).


### Level 1 (L1)

**Description:** Raw data packaged with ancillary information and converted and standardized to an open convention and standard data formats. Use of the ICES (International Council for the Exploration of the Sea) SONAR-netcDF4 version 1 convention (Macaulay & Peña, 2018) is strongly recommended. While individual pings are not georeferenced, latitude and longitude coordinates are included and can be interpolated to each ping based on timestamps. Say something about the scope of (optional) L1B?

L1 data is further categorized into two sub-levels:

- **L1A:** Raw L0 data converted to a standardized, open format with geographic coordinates (latitude & longitude) included. Includes other ancillary information extracted from sensor-generated L0 data or other external sources. May include environmental information such as temperature, salinity and pressure. 
- **L1B:** L1A data with quality-control steps applied, such as time-coordinate corrections that enforce strictly increasing, non-duplicate timestamps.

L1 data may be distributed in the following two forms:

- As sets of individual converted files as originally segmented into arbitrary time ranges during sensor file creation, or
- Compiled into larger granules corresponding to logical deployment intervals while the sensor is active continuously. For a mooring, this may be a daily granule if the sensor is turned off on a daily cycle, while for a cruise it may represent well defined transects.

**Rationale:** Previous initiatives that have adopted data processing levels for their echosounder data holdings have focused their efforts on processed products that are most widely used, starting with _Sv_ and similar variables (see ADEON and IMOS discussions, above). While ADEON and IMOS use different processing levels to designate this starting point (L1 and L2, respectively), both lack a more user-accessible intermediate level between the original raw data files generated by the instruments (L0) and the processed products. The need for improved accessibility to raw data motivated the development of the SONAR-netCDF4 convention (particularly version 1) and is also borne out by the development of data repositories such as the NOAA Water Column Sonar Data Archive (Wall, 2016). We adopt L1 as the data processing level that reflects raw data together with metadata ancillary data converted to an accessible, convention format, SONAR-netCDF4. This approach reflects the CEOS (2008) definition for L1 data (“Unpacked, reformatted level 0 data, with all supplemental information to be used in subsequent processing appended”). It is also consistent with the NASA EOS L1A definition and NASA EOS’ use of standardized, metadata-rich data formats for data products.

Add something about L1A vs L1B?


### Level 2 (L2)

**Description:** Calibrated acoustic quantities at raw data resolution and with spatial coordinates (latitude, longitude and depth) interpolated to all pings. May include noise removal or other filtering.

- **L2A:** Volume backscattering strength (_Sv_) or target strength (_TS_) with interpolated latitude, longitude and depth coordinates. May incorporate additional information, such as split beam angle. Masks derived from these products will also be L2A products.
- **L2B:** _Sv_ or _TS_ L2A data with noise removal or other data filtering applied, such as seafloor bottom removal.

**Rationale:** The focus of L2 products in conventional data processing level schemes such as NASA EOS and CEOS is on “retrieval” of geophysical or biophysical variables from radiometric variables, at the same resolution as the input L1 data (CEOS, 2008; Mittaz et al, 2019; NASA, 2021). Radiometric calibration parameters present in L1 products are applied. Using the NASA MODIS sensor as an example, L2 ocean products include sea surface temperature and chlorophyll-a pigment concentration (Parkinson & Greenstone, 2000). For echosounder data, in contrast, calibrated and filtered acoustic quantities serve as the underlying variables that are examined directly or used for regridded products and aggregated metrics. We follow the approach used by ADEON and IMOS, where the next processing level after raw data (in our case, after the raw data was converted to an L1 product) is calibrated _Sv_ (or _TS_). This L2A product corresponds to ADEON L1 and IMOS L2 products. Additional processing involving noise characterization and removal and seafloor removal without a change in resolution are categorized as L2B, corresponding to ADEON L2 processing steps and IMOS L2 products.


### Level 3 (L3)

**Description:** Calibrated acoustic quantities regridded or aggregated to a common grid across channels. May include noise removal or other filtering.

- _Sv_ resampled to a common, high-resolution grid across channels
- Mean Volume Backscattering Strength (_MVBS_)
- Masks (including seafloor – and surface? – removal) applied to _Sv_ based on different scattering source classification criteria and methods, such as frequency difference across two channels.

L3 data is further categorized into two sub-levels:

- **L3A:** The above variables computed on L2A data
- **L3B:** The above variables computed on L2B (filtered) data

**Rationale:** 

In NASA lingo, often described as gridded data (“uniform space-time grid”).

Mittaz et al, 2019: “L3 products are gridded products, made by aggregating L2 values in space and/or time on a regular space-time grid. Aggregation involves the averaging of the L2 data obtained within the space-time volume of a given cell”

ADEON (L2) vs IMOS (L2)


### Level 4 (L4)

**Description:** Acoustically derived biological, environmental, and other features, involving further processing of L3 data that may include data reduction or incorporation of external sources of data.

- Nautical Area Backscattering Coefficients (_NASC_), potentially partitioned into inferred sources of scattering
- Summary statistics of echogram features (center of mass, dispersion, etc)
- Taxon or species-level data labels (classification). May originate from a variety of methods, including frequency difference thresholds.
- Estimated biomass, combined or partitioned into different taxonomic sources.

**Rationale:**
