# Proposed processing levels and sub-levels

Our proposal for echosounder data processing levels is strongly guided by the most widely used NASA EOS scheme {cite}`weaver_processing_2014,nasa_data_2021` and also informed by the two existing implementations for echosounder data. We follow the NASA EOS number and sequence of levels from L0 to L4. We also adopt two sub-level designations for L1, L2 and L3, where the “B” sub-level data are the “A” sub-level data with additional quality control or data filtering processing steps applied. As with all other schemes, except for L0, only data products with geolocation information are assigned a data processing level code.

These decisions are made based on [our review](./review.md) of existing data processing level categorizations in the environmental monitoring community and the limited implementations on echosounder data, which highlights both broad consistencies in the progression of processing levels and the criteria used to distinguish between levels, as well as the considerable differences that reflect specific features of the observing system or goals of the group implementing the data processing level scheme.

 <!-- [keeping below as comments for now to keep text focused and avoid repetition] For example, L1 sometimes accommodates data products with calibration already applied. Geolocation is sometimes assigned at every data point at L1 rather than L2. Quality control steps, such as those involving distortions or noise, occur in both L1 and L2. Sub-level designations, when used, have poorly standardized meanings. -->

Below are our proposed data processing levels for echosounder data.
<!-- [remove for now and add back once filtering and classification levels are determined] , with reference to the associated implementation in the software [echopype](https://echopype.readthedocs.io) when appropriate. -->


## Level 0 (L0)

**Description:** Raw data in manufacturer sensor format. The data files are typically binary. The associated metadata may be found in external files.

**Rationale:** The use of L0 data processing level for raw data files in their original format is the most widespread practice in both satellite remote sensing programs {cite}`weaver_processing_2014,mittaz_applying_2019,nasa_data_2021`  and existing echosounder data implementations {cite}`haris_imos_2018,heaney_adeon_2020`.


## Level 1 (L1)

**Description:** Raw data packaged with ancillary information and converted and standardized to common data formats based on an open convention. Use of the ICES (International Council for the Exploration of the Sea) SONAR-netcDF4 version 1 convention {cite}`macaulay_pena_2018` is strongly recommended. While individual echosounder pings may not be georeferenced, latitude and longitude coordinates are included in the data and can be interpolated to each ping based on the timestamps.

L1 data is further categorized into two sub-levels:

- **L1A:** Raw L0 data converted to a standardized, open format with geographic coordinates (latitude & longitude) included. The data include other ancillary information extracted from echosounder-generated L0 data or other external sources, and may include environmental information such as temperature, salinity and pressure.
- **L1B:** L1A data with quality-control steps applied, such as time-coordinate corrections that enforce strictly increasing, non-duplicate timestamps.

L1 data may be distributed in the following two forms:

- Sets of individual files converted from raw L0 data created by the echosounder instrument, or
- Larger granules of compiled converted files corresponding to logical deployment or data collection intervals while the echosounder pings continuously. For a mooring, this may be a daily granule if the sensor is turned off on a daily cycle. For a research cruise, each granule may represent well defined transects.

**Rationale:** Existing implementations of echosounder data processing levels have focused their efforts on processed data products, starting with Sv and similar variables. While ADEON and IMOS use different processing levels to designate this starting point (L1 and L2, respectively), both lack a more user-accessible intermediate level between the original raw data files generated by the instruments (L0) and the processed data products. The SONAR-netCDF4 convention (particularly version 1) is motivated by the need for improved accessibility to raw data as well as the development of data repositories such as the NOAA Water Column Sonar Data Archive {cite}`wall_2016`.

We designate L1 as the data processing level that contains raw data together with metadata and ancillary data converted to an accessible data format following the SONAR-netCDF4 convention. This approach follows the CEOS {cite}`ceos_interoperability_2008` definition for L1 data ("Unpacked, reformatted level 0 data, with all supplemental information to be used in subsequent processing appended"). It is also consistent with the NASA EOS L1A definition and NASA EOS' use of standardized, metadata-rich formats for data products.


## Level 2 (L2)

**Description:** Calibrated acoustic quantities at raw data resolution, with spatial coordinates (latitude, longitude and depth) interpolated to all pings. 
<!-- The data may include noise removal or other filtering. -->

- **L2A:** Volume backscattering strength (Sv) or target strength (TS) with interpolated latitude, longitude and depth coordinates. The data may incorporate additional information, such as split beam angle.
<!-- Masks derived from these products, such as seafloor bottom mask, will also be designated as L2A products. -->
- **L2B:** Sv or TS L2A data with noise removal or other data filtering applied, such as seafloor bottom removal.

**Rationale:** The focus of L2 products in widely used data processing level schemes is on "retrieval" of geophysical or biophysical variables from radiometric variables, at the same resolution as the input L1 data {cite}`ceos_interoperability_2008,mittaz_applying_2019,nasa_data_2021`. For the NASA MODIS sensor, radiometric calibration parameters from L1 are applied to derive L2 ocean products such as the sea surface temperature and chlorophyll-a pigment concentration {cite}`parkinson_eos_2000`.

For echosounder data, we follow the approach used by ADEON and IMOS, where the next processing level following raw data conversion and standarization (L1) is calibrated acoustic quantities such as Sv and TS. The proposed L2A product corresponds to ADEON L1 and IMOS L2 products. Additional processing involving noise filtering and seafloor removal without resolution change are categorized as L2B, which corresponds to ADEON L2 processing steps and IMOS L2 products.


## Level 3 (L3)

**Description:** Calibrated acoustic quantities regridded or aggregated to a common grid across echsoounder channels. The data may include noise removal or other filtering. L3 products may include:

- Sv resampled to a common, high-resolution grid across channels
- Mean Volume Backscattering Strength (MVBS)
<!-- [not sure why this is in L4] - Masks applied to Sv based on different scattering source classification methods, such as frequency differencing across two channels -->

L3 data is further categorized into two sub-levels:

- **L3A:** The above variables computed on L2A data.
- **L3B:** The above variables computed on L2B (filtered) data.

**Rationale:** L3 products are commonly defined as data spatially and/or temporally re-sampled (regridded) on a regular space-time grid {cite}`ceos_interoperability_2008,mittaz_applying_2019,nasa_data_2021`. They are often referred to as gridded data. ADEON incorporates this regular gridding in the L2 product. IMOS also includes gridded variables in its L2 product. However, IMOS L2 is a broad designation encompassing products that have undergone a wide range of processing steps. Following the conventional L3 definition, we designate L3 to include the outcome of resampling or binning L2 data onto a common grid, often at a resolution coarser than the original data.


## Level 4 (L4)

**Description:** Acoustically derived biological, environmental, and other features, involving further processing of L3 data that may include data reduction or incorporation of external sources of data. L4 products may include:

- Nautical Area Backscattering Coefficients (NASC), potentially partitioned into different sources of scattering
- Summary statistics of echogram features (center of mass, dispersion, etc)
- Taxon or species-level data labels (classification outcome)
- Estimated biomass, combined or partitioned into different taxonomic groups

**Rationale:** L4 data are typically defined as highly processed products resulting from models or analysis of lower-level data. For satellite products, they are often complete, continuous fields without gaps and may involve data from different sensors {cite}`mittaz_applying_2019`. For example, ocean primary production from the MODIS sensor is a L4 product {cite}`parkinson_eos_2000`.

The ADEON processing levels beyond L2 are specified contains gridded products including NASC, but are not clearly described {cite}`heaney_adeon_2020`. IMOS products are all designated as L2 and include derived variables ("metrics") that are the result of integrating Sv along a depth interval such as the 20-200 m "epipelagic" zone. Here we include in L4 a collection of highly processed products (e.g., NASC, biomass) and metrics that depend on L3 products, particularly ones that are partitioned by taxonomic groupings derived either from external information or directly from analysis of acoustic.
